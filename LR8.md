# Отчет по восьмой лабораторной работе


# Описание программы
В качестве com объекта была выбрана работа с числами, а именно: нахождение простых чисел, чисел Фибоначчи, вычисление факториала. На вход программе поступает натуральное число. Рассмотрим каждую задачу:
1. Нахождение факториала числа. На выход поступает число, результат вычислений – факториал заданного числа.
2. Нахождение простых чисел. На выход поступает список полученных чисел до заданного числа.
3. Нахождение чисел Фибоначчи. На выход поступает список чисел до заданного числа.


# 1. Опишите процедуру создания COM объекта?
Для создания COM объекта необходимо создать библиотеку классов и установить ей свойство регистрация для COM-взаимодействия. В коде COM объекта необходимо создать класс и интерфейс. Класс и интерфейс нужно пометить рядом атрибутов: следует указать для них уникальные GUID-ы, указать ComVisible(true), а для класса также добавить атрибут ClassInterface(ClassInterfaceType.None). После этого необходимо собрать проект.


# 2. Что такое интерфейс СОМ объекта, его назначение?
COM (англ. Component Object Model «модель компонентного объекта») — это технологический стандарт от компании Microsoft, предназначенный для создания программного обеспечения на основе взаимодействующих компонентов объекта, каждый из которых может использоваться во многих программах одновременно. Интерфейс СОМ предназначен для связи между компонентами и включает в себя набор функций, которые реализуются компонентами и используются клиентами. Свойства СОМ-интерфейса такие: у каждого интерфейса имеется два идентификатора (пользовательский идентификатор и глобальный уникальный идентификатор); интерфейсы после своего опубликования не могут быть изменены; добавление новой функциональности требует определения нового интерфейса; для интерфейса определен стандартный двоичный формат; каждый интерфейс наследует стандартный интерфейс IUnknown; СОМ-объект может описывать свои интерфейсы на любом язы


# 3. Назначение библиотеки СОМ. Механизм создания первого экземпляра объекта с помощью библиотеки СОМ и системного реестра.?
Библиотека СОМ предназначена для выполнения базовых функций и идентификации требуемого интерфейса. При попытке клиента использовать некоторый объект СОМ, который до этого момента не использовался и, следовательно, клиент не мог получить указатели на объект и интерфейс, он обращается к библиотеке СОМ и вызывает метод CoCreateInstance, передавая ей в качестве параметра CLSID нужного класса, IDD интерфейса и требуемый тип сервера.
Библиотека при помощи диспетчера управления службами обращается в системному реестру, по идентификатору класса находит информацию
и сервере и запускает его. Сервер создает экземпляр класса – объект, и возвращает библиотеке указатель на запрошенный интерфейс.
Библиотека СОМ передает указатель клиенту, который впоследствии может обращаться непосредственно к объекту.


# 4. Что такое СОМ-сервер?
Сервер COM является приложением или библиотекой, которая предоставляет сервис клиентскому приложению (или библиотеке). Сервер включает по крайней мере один объект COM, который в свою очередь представляет собой совокупность методов и свойств. Клиент не обязан знать, где в памяти располагаются объекты COM.
Когда клиент запрашивает сервис у объекта COM, он (клиент) должен передать идентификатор класса CLSID. Идентификатор класса CLSID создается на основе GUID интерфейса объекта COM.
По идентификатору класса CLSID COM определяет соответствующий сервер, загружает его в память и сервер создает экземпляр объекта COM. Экземпляры объектов COM создает фабрика классов, к которой обращается сервер. Фабрика классов имеет свой интерфейс.


